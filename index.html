<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study English with AI!</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Settings Button */
        .settings-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            z-index: 1000;
            border: 2px solid #e0e0e0;
        }

        .settings-btn:hover {
            transform: rotate(90deg);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }

        .settings-icon {
            width: 24px;
            height: 24px;
            fill: #666;
        }

        /* Settings Modal */
        .settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .settings-modal.active {
            display: flex;
        }

        .settings-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .settings-header h3 {
            color: #333;
            font-size: 24px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 28px;
            color: #999;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
        }

        .close-btn:hover {
            color: #333;
        }

        .api-input-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .api-input-group input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
        }

        .api-input-group input:focus {
            outline: none;
            border-color: #4a90e2;
        }

        .api-input-group button {
            padding: 12px 24px;
            background: #4a90e2;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .api-input-group button:hover {
            background: #357abd;
        }

        .api-status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            font-size: 14px;
        }

        .api-status.success {
            background: #d4f4dd;
            color: #2e7d32;
        }

        .api-status.error {
            background: #ffebee;
            color: #c62828;
        }

        /* Navigation */
        nav {
            background: white;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-btn {
            padding: 12px 24px;
            background: white;
            color: #333;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: #f8f9fa;
            border-color: #4a90e2;
            color: #4a90e2;
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: #4a90e2;
            color: white;
            border-color: #4a90e2;
        }

        /* Content Area */
        .content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            min-height: 500px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Home Page */
        .home-container {
            text-align: center;
            padding: 60px 20px;
        }

        .home-title {
            font-size: 48px;
            color: #333;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .home-subtitle {
            font-size: 18px;
            color: #666;
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .powered-by {
            font-size: 14px;
            color: #999;
            margin-top: 40px;
        }

        .powered-by span {
            color: #4a90e2;
            font-weight: 600;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 50px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .feature-card {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .feature-card:hover {
            background: #e9ecef;
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .feature-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 28px;
        }

        /* Vocabulary Cards */
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .flip-card {
            background-color: transparent;
            width: 100%;
            height: 200px;
            perspective: 1000px;
            cursor: pointer;
        }

        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }

        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .flip-card-front {
            background: linear-gradient(135deg, #4a90e2 0%, #5ca0f2 100%);
            color: white;
        }

        .flip-card-back {
            background: linear-gradient(135deg, #48c774 0%, #3ec46d 100%);
            color: white;
            transform: rotateY(180deg);
        }

        /* Writing Section */
        .writing-container {
            max-width: 700px;
            margin: 0 auto;
        }

        .sentence-display {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 20px;
            text-align: center;
            color: #333;
            border: 2px solid #e0e0e0;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #666;
            font-weight: 600;
        }

        .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            resize: vertical;
            min-height: 100px;
        }

        .input-group textarea:focus {
            outline: none;
            border-color: #4a90e2;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: #4a90e2;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            background: #357abd;
            transform: translateY(-2px);
        }

        .feedback {
            margin-top: 20px;
            padding: 20px;
            background: #f0f7ff;
            border-radius: 10px;
            border-left: 4px solid #4a90e2;
        }

        /* Speaking Section */
        .speaking-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .topic-selector {
            flex: 1;
            min-width: 200px;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
        }

        .call-btn {
            padding: 12px 30px;
            background: #48c774;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .call-btn:hover {
            background: #3ec46d;
        }

        .call-btn.active {
            background: #ff3860;
        }

        .call-btn.active:hover {
            background: #ff1443;
        }

        .chat-log {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            height: 400px;
            overflow-y: auto;
            border: 2px solid #e0e0e0;
        }

        .chat-message {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
        }

        .chat-message.user {
            background: #e3f2fd;
            margin-left: 20%;
        }

        .chat-message.ai {
            background: #f3e5f5;
            margin-right: 20%;
        }

        /* Listening Section */
        .audio-controls {
            margin: 20px 0;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .play-btn {
            padding: 12px 30px;
            background: #ff9500;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-btn:hover {
            background: #e68600;
        }

        .question-box {
            background: #fff8e1;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #ffe082;
        }

        /* Reading Section */
        .drop-zone {
            border: 3px dashed #4a90e2;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            background: #f8f9ff;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .drop-zone:hover {
            background: #eff1ff;
            border-color: #357abd;
        }

        .drop-zone.dragging {
            background: #e8ebff;
            border-color: #2968c8;
        }

        .translation-results {
            margin-top: 30px;
        }

        .sentence-pair {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px solid #e0e0e0;
        }

        .original {
            color: #333;
            font-size: 16px;
            margin-bottom: 8px;
        }

        .translated {
            color: #4a90e2;
            font-size: 16px;
            font-weight: 600;
        }

        /* Loading Spinner */
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4a90e2;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Settings Button -->
        <div class="settings-btn" onclick="toggleSettings()">
            <svg class="settings-icon" viewBox="0 0 24 24">
                <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5a3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97c0-.33-.03-.65-.07-.97l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.08-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.32-.07.64-.07.97c0 .33.03.65.07.97l-2.11 1.63c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.39 1.06.73 1.69.98l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.25 1.17-.59 1.69-.98l2.49 1c.22.08.49 0 .61-.22l2-3.46c.13-.22.07-.49-.12-.64l-2.11-1.63Z"/>
            </svg>
        </div>

        <!-- Settings Modal -->
        <div class="settings-modal" id="settingsModal">
            <div class="settings-content">
                <div class="settings-header">
                    <h3>⚙️ Settings</h3>
                    <button class="close-btn" onclick="toggleSettings()">×</button>
                </div>
                <p style="color: #666; margin-bottom: 15px;">Enter your OpenAI API key to enable all features. Your key is stored only in this browser session.</p>
                <div class="api-input-group">
                    <input type="password" id="apiKeyInput" placeholder="sk-..." />
                    <button onclick="saveApiKey()">Save Key</button>
                </div>
                <div id="apiStatus" class="api-status" style="display: none;"></div>
            </div>
        </div>

        <!-- Navigation -->
        <nav>
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showPage('home')">🏠 Home</button>
                <button class="nav-btn" onclick="showPage('vocabulary')">📚 Vocabulary</button>
                <button class="nav-btn" onclick="showPage('writing')">✍️ Writing</button>
                <button class="nav-btn" onclick="showPage('speaking')">🗣️ Speaking</button>
                <button class="nav-btn" onclick="showPage('listening')">👂 Listening</button>
                <button class="nav-btn" onclick="showPage('reading')">📖 Reading</button>
            </div>
        </nav>

        <!-- Content Area -->
        <div class="content">
            <!-- Home Page -->
            <div id="home" class="page active">
                <div class="home-container">
                    <h1 class="home-title">Study English with AI!</h1>
                    <p class="home-subtitle">
                        Master English through interactive AI-powered lessons.<br>
                        Practice vocabulary, writing, speaking, listening, and reading skills.
                    </p>
                    
                    <div class="feature-grid">
                        <div class="feature-card" onclick="showPage('vocabulary')">
                            <div class="feature-icon">📚</div>
                            <div class="feature-title">Vocabulary</div>
                        </div>
                        <div class="feature-card" onclick="showPage('writing')">
                            <div class="feature-icon">✍️</div>
                            <div class="feature-title">Writing</div>
                        </div>
                        <div class="feature-card" onclick="showPage('speaking')">
                            <div class="feature-icon">🗣️</div>
                            <div class="feature-title">Speaking</div>
                        </div>
                        <div class="feature-card" onclick="showPage('listening')">
                            <div class="feature-icon">👂</div>
                            <div class="feature-title">Listening</div>
                        </div>
                        <div class="feature-card" onclick="showPage('reading')">
                            <div class="feature-icon">📖</div>
                            <div class="feature-title">Reading</div>
                        </div>
                    </div>
                    
                    <div class="powered-by">
                        Powered by <span>Sean</span> and <span>Claude Opus 4.1</span> and <span>ChatGPT5</span>
                    </div>
                </div>
            </div>

            <!-- Vocabulary Page -->
            <div id="vocabulary" class="page">
                <h2>Vocabulary Practice</h2>
                <p>Click on cards to flip them and see translations!</p>
                <div class="card-container">
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">안녕하세요</div>
                            <div class="flip-card-back">Hello</div>
                        </div>
                    </div>
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">감사합니다</div>
                            <div class="flip-card-back">Thank you</div>
                        </div>
                    </div>
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">사랑해요</div>
                            <div class="flip-card-back">I love you</div>
                        </div>
                    </div>
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">친구</div>
                            <div class="flip-card-back">Friend</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Writing Page -->
            <div id="writing" class="page">
                <h2>Writing Practice</h2>
                <div class="writing-container">
                    <div class="sentence-display">
                        오늘 날씨가 정말 좋아요.
                    </div>
                    <div class="input-group">
                        <label>Your English Translation:</label>
                        <textarea id="translationInput" placeholder="Enter your translation here..."></textarea>
                    </div>
                    <div class="input-group">
                        <label>Reasoning (if unsure):</label>
                        <textarea id="reasoningInput" placeholder="Explain what you're unsure about..."></textarea>
                    </div>
                    <button class="submit-btn" onclick="submitTranslation()">Submit for Evaluation</button>
                    <div id="writingFeedback" class="feedback" style="display: none;"></div>
                </div>
            </div>

            <!-- Speaking Page -->
            <div id="speaking" class="page">
                <h2>Speaking Practice</h2>
                <div class="speaking-controls">
                    <select class="topic-selector" id="topicSelector">
                        <option value="restaurant">🍽️ Restaurant</option>
                        <option value="shopping">🛍️ Shopping</option>
                        <option value="directions">🗺️ Asking Directions</option>
                        <option value="hotel">🏨 Hotel</option>
                        <option value="introduction">👋 Self Introduction</option>
                    </select>
                    <button class="call-btn" onclick="toggleCall()" id="callBtn">Start Call</button>
                </div>
                <div class="chat-log" id="chatLog">
                    <div class="chat-message ai">AI: 안녕하세요! Ready to practice speaking? Select a topic and click "Start Call".</div>
                </div>
            </div>

            <!-- Listening Page -->
            <div id="listening" class="page">
                <h2>Listening Practice</h2>
                <div class="audio-controls">
                    <button class="play-btn" onclick="playAudio()">🔊 Play Audio</button>
                    <span>Listen carefully and answer the question below</span>
                </div>
                <div class="question-box">
                    <h3>Question:</h3>
                    <p id="listeningQuestion">Click "Play Audio" to hear the paragraph, then a question will appear here.</p>
                </div>
                <div class="input-group">
                    <label>Your Answer:</label>
                    <textarea id="listeningAnswer" placeholder="Type your answer here..."></textarea>
                </div>
                <button class="submit-btn" onclick="submitListeningAnswer()">Submit Answer</button>
                <div id="listeningFeedback" class="feedback" style="display: none;"></div>
            </div>

            <!-- Reading Page -->
            <div id="reading" class="page">
                <h2>Reading Practice</h2>
                <div class="drop-zone" id="dropZone" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                    <h3>📷 Drop an image here</h3>
                    <p>or click to select a file</p>
                    <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="handleFileSelect(event)">
                </div>
                <div class="translation-results" id="translationResults" style="display: none;">
                    <h3>Parsed and Translated Sentences:</h3>
                    <div id="sentencesList"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API Key Management
        let API_KEY = sessionStorage.getItem('openai_api_key') || '';

        function toggleSettings() {
            const modal = document.getElementById('settingsModal');
            modal.classList.toggle('active');
        }

        function saveApiKey() {
            const key = document.getElementById('apiKeyInput').value.trim();
            if (!key) {
                showApiStatus('Please enter an API key', 'error');
                return;
            }
            
            API_KEY = key;
            sessionStorage.setItem('openai_api_key', key);
            document.getElementById('apiKeyInput').value = '';
            showApiStatus('API key saved successfully!', 'success');
        }

        function showApiStatus(message, type) {
            const status = document.getElementById('apiStatus');
            status.textContent = message;
            status.className = `api-status ${type}`;
            status.style.display = 'block';
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 3000);
        }

        // Check for saved API key on load
        window.onload = function() {
            if (API_KEY) {
                console.log('API key loaded from session');
            }
        };

        // Close modal when clicking outside
        document.getElementById('settingsModal').addEventListener('click', function(e) {
            if (e.target === this) {
                toggleSettings();
            }
        });

        // Navigation
        function showPage(pageId) {
            // Hide all pages
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            
            // Remove active class from all nav buttons
            const navBtns = document.querySelectorAll('.nav-btn');
            navBtns.forEach(btn => btn.classList.remove('active'));
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Add active class to clicked button or home button
            const clickedBtn = Array.from(navBtns).find(btn => 
                btn.textContent.toLowerCase().includes(pageId)
            );
            if (clickedBtn) {
                clickedBtn.classList.add('active');
            }
        }

        // Vocabulary Functions
        function flipCard(card) {
            card.classList.toggle('flipped');
        }

        // Writing Functions
        async function submitTranslation() {
            if (!API_KEY) {
                alert('Please set your API key first! Click the settings button in the top right.');
                return;
            }

            const translation = document.getElementById('translationInput').value;
            const reasoning = document.getElementById('reasoningInput').value;
            
            if (!translation) {
                alert('Please enter a translation!');
                return;
            }

            const feedback = document.getElementById('writingFeedback');
            feedback.innerHTML = '<div class="spinner"></div>';
            feedback.style.display = 'block';

            // Simulate API call (replace with actual API call)
            setTimeout(() => {
                feedback.innerHTML = `
                    <h3>Evaluation Results:</h3>
                    <p><strong>Your translation:</strong> ${translation}</p>
                    <p><strong>Correct translation:</strong> The weather is really nice today.</p>
                    <p><strong>Feedback:</strong> Great job! Your translation captures the meaning well.</p>
                    ${reasoning ? `<p><strong>Your reasoning:</strong> ${reasoning}</p>` : ''}
                `;
            }, 1500);
        }

        // Speaking Functions
        let isCallActive = false;
        
        function toggleCall() {
            if (!API_KEY) {
                alert('Please set your API key first! Click the settings button in the top right.');
                return;
            }

            const btn = document.getElementById('callBtn');
            const chatLog = document.getElementById('chatLog');
            
            isCallActive = !isCallActive;
            
            if (isCallActive) {
                btn.textContent = 'End Call';
                btn.classList.add('active');
                
                const topic = document.getElementById('topicSelector').value;
                addChatMessage('ai', `Let's practice ${topic} conversation! 안녕하세요! 무엇을 도와드릴까요?`);
                
                // Simulate conversation
                setTimeout(() => {
                    addChatMessage('user', 'Hello! I would like to order food.');
                }, 2000);
            } else {
                btn.textContent = 'Start Call';
                btn.classList.remove('active');
                addChatMessage('ai', 'Call ended. Great practice session! Here are some tips for improvement...');
            }
        }

        function addChatMessage(sender, message) {
            const chatLog = document.getElementById('chatLog');
            const msgDiv = document.createElement('div');
            msgDiv.className = `chat-message ${sender}`;
            msgDiv.textContent = `${sender.toUpperCase()}: ${message}`;
            chatLog.appendChild(msgDiv);
            chatLog.scrollTop = chatLog.scrollHeight;
        }

        // Listening Functions
        function playAudio() {
            if (!API_KEY) {
                alert('Please set your API key first! Click the settings button in the top right.');
                return;
            }

            // Simulate playing audio and showing question
            document.getElementById('listeningQuestion').textContent = 
                'What did the speaker say about the weather?';
            
            // In real implementation, this would use TTS API
            alert('Audio would play here: "오늘 날씨가 정말 좋아요. 공원에 가고 싶어요."');
        }

        function submitListeningAnswer() {
            if (!API_KEY) {
                alert('Please set your API key first! Click the settings button in the top right.');
                return;
            }

            const answer = document.getElementById('listeningAnswer').value;
            if (!answer) {
                alert('Please enter an answer!');
                return;
            }

            const feedback = document.getElementById('listeningFeedback');
            feedback.innerHTML = '<div class="spinner"></div>';
            feedback.style.display = 'block';

            setTimeout(() => {
                feedback.innerHTML = `
                    <h3>Results:</h3>
                    <p><strong>Your answer:</strong> ${answer}</p>
                    <p><strong>Correct answer:</strong> The speaker said the weather is really nice today and they want to go to the park.</p>
                    <p><strong>Score:</strong> 85% - Good comprehension!</p>
                `;
            }, 1500);
        }

        // Reading Functions
        document.getElementById('dropZone').addEventListener('click', () => {
            document.getElementById('fileInput').click();
        });

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragging');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('dragging');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragging');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                processImage(files[0]);
            }
        }

        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (file) {
                processImage(file);
            }
        }

        function processImage(file) {
            if (!API_KEY) {
                alert('Please set your API key first! Click the settings button in the top right.');
                return;
            }

            if (!file.type.startsWith('image/')) {
                alert('Please select an image file!');
                return;
            }

            const results = document.getElementById('translationResults');
            const sentencesList = document.getElementById('sentencesList');
            
            sentencesList.innerHTML = '<div class="spinner"></div>';
            results.style.display = 'block';

            // Simulate OCR and translation (replace with actual API calls)
            setTimeout(() => {
                sentencesList.innerHTML = `
                    <div class="sentence-pair">
                        <div class="original">The quick brown fox jumps over the lazy dog.</div>
                        <div class="translated">재빠른 갈색 여우가 게으른 개를 뛰어넘습니다.</div>
                    </div>
                    <div class="sentence-pair">
                        <div class="original">Learning a new language opens many doors.</div>
                        <div class="translated">새로운 언어를 배우는 것은 많은 문을 열어줍니다.</div>
                    </div>
                    <div class="sentence-pair">
                        <div class="original">Practice makes perfect.</div>
                        <div class="translated">연습이 완벽을 만듭니다.</div>
                    </div>
                `;
            }, 2000);
        }

        // Simulated sentences for practice
        const koreanSentences = [
            "오늘 날씨가 정말 좋아요.",
            "커피 한 잔 주세요.",
            "이것은 얼마예요?",
            "도와주셔서 감사합니다.",
            "한국 음식을 좋아해요."
        ];

        // Rotate sentences in writing section
        let currentSentenceIndex = 0;
        setInterval(() => {
            const sentenceDisplay = document.querySelector('.sentence-display');
            if (sentenceDisplay && document.getElementById('writing').classList.contains('active')) {
                currentSentenceIndex = (currentSentenceIndex + 1) % koreanSentences.length;
                sentenceDisplay.textContent = koreanSentences[currentSentenceIndex];
            }
        }, 30000); // Change every 30 seconds
    </script>
</body>
</html>